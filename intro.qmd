# Introduction: Market Equilibrium

This website is a compilation of my economics classes' notes and its goal is to provide summaries of important topics in heterodox economics. Since having some basics in mainstream economics is crucial to understand the main schools of heterodox economics, mainly because heterodox economics is constructed partly as a response and critic of mainstream-neoclassical economics, the present introduction will summarize the basics of neoclassical production and consumer theory, the two foundations of market equilibrium.

Let's first recall what market equilibrium is, because it is one of the most important concept in economics.


```{r}
#| echo: false
#| message: false
#| warning: false

library(Deriv)
library(tidyverse)
library(pander)
library(matlib)
library(readxl)
library(mosaic)
library(reconPlots)
library(Ryacas0)
theme_set(theme_light())
```

## Market equilibrium

Market equilibrium is perhaps the most important element of neoclassical theory. Stated simply, market equilibrium tells what will be the price of any object or service, as long as the latters are commodified. Market equilibrium explains not only the equilirbium level of prices and commodities of any good or service, but also the change in prices resulting from exogenous shocks (change in income, confidence, technology...)

Let's directly take an example: suppose that the demand for grain follows a negative linear function.

$Q_{demand} = 7-0.5p$

That means that the quantity demanded for grains decreases if the price for grain increases and vice and versa.

Moreover, let's say that the quantity supplied for grains is a positive linear function of prices for grain: the higher the price, the more are firms willing to supply grains.

$Q_{supply} = 1+0.6p$

```{r}
demand <- function(p) 7 - (0.5*p)
supply <- function(p) 1 + 0.6*p
```

```{r}
#| echo: false

ggplot(data = tibble(x = 0:10), aes(x = x))+
  geom_function(fun = demand, aes(color = "demand"), linewidth = 1.3)+
  geom_function(fun = supply, aes(color = "supply"), linewidth = 1.3)+
  labs(title = "Market equilibrium",
       y = "price",
       x = "quantity")+
  scale_y_continuous(labels = scales::dollar)+
  theme(legend.position = "bottom")

```

To find the equilibrium price and quantity, we equate the demand and supply functions and solve for q:

$$
\begin{aligned}
q_{demand} = 7- 0.5*p
\\
q_{supply} = 1 + 0.6*p 
\\
q_{demand} = q_{supply}
\\
7 - 0.5*p = 1 + 0.6*p
\\
6-0.11p = 0
\\
p^* = 6/1.1 = 5.45
\end{aligned}
$$

The equilibrium price level is thus $p^* = 5.45$. To find the equilibrium quantity, we simple put the value of the equilibrium price (5.45) into either the supply or demand function: $7-0.5*5.45 = 4.275 = p^*$

It is easy to check directly if the computation is correct in r:

```{r}
equilibrium <- curve_intersect(demand, supply, empirical = FALSE, domain = c(1,10))
equilibrium
```

```{r}
#| echo: false

ggplot(data = tibble(x = 0:10), aes(x = x))+
  geom_function(fun = demand, aes(color = "demand"), linewidth = 1.3)+
  geom_function(fun = supply, aes(color = "supply"), linewidth = 1.3)+
  labs(title = "Market equilibrium",
       y = "Equilibrium price = 4.27",
       x = "Equilibrium quantity = 5.4545")+
  scale_y_continuous(labels = scales::dollar)+
  theme(legend.position = "bottom")+
  annotate(geom = "segment", x = 5.45, y = 0, xend = 5.45, yend = 4.27, linetype = "dashed")+
  annotate(geom = "segment", x = 0, y = 4.27, xend = 5.45, yend = 4.27, linetype = "dashed")
```

But how did neoclassical theory arrive to this kind of model of equilibrium price and quantity determination? To understand better this model, we need to know why we have this positive supply curve and this negative demand curve. We will first investigate consumer choice theory, which is behind the negative demand curve, and then production-side theory, which is behind the positive supply curve.

